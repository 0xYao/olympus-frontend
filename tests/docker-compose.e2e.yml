version: "3.2"
services:
  tests:
    build:
      context: ..
      dockerfile: tests/Dockerfile
    # When running using CI, we are likely to define these values through environment variables
    environment:
      - REACT_APP_XVFB_ENABLED=true
    #   - PRIVATE_KEY=${CONTRACT_NODE_PRIVATE_KEY}
    #   - ALCHEMY_API_KEY=${CONTRACT_NODE_ALCHEMY_API_KEY}
    # But the .env file is more likely for local development
    # env_file:
    #   - .env
    # We use the host mode so that "localhost" can be accessed
    network_mode: host
    # TODO add dependency on contract_node after the healthcheck is merged
    depends_on:
      frontend:
        condition: service_healthy
    volumes:
      # Mount the root directory
      - ../:/usr/src/app/

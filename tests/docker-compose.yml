version: "3.2"
services:
  # Runs the Hardhat node on an ongoing basis
  contract_node:
    # TODO shift to official repo
    image: ghcr.io/0xjem/olympus-contracts:${DOCKER_IMAGE}
    ports:
      - 8545:8545
    # When running using CI, we are likely to define these values through environment variables
    environment:
      - PRIVATE_KEY=${CONTRACT_NODE_PRIVATE_KEY}
      - ALCHEMY_API_KEY=${CONTRACT_NODE_ALCHEMY_API_KEY}
    # But the .env file is more likely for local development
    env_file:
      - .env
  frontend:
    build:
      context: ..
      dockerfile: Dockerfile
    ports:
      - 3000:3000
    depends_on:
      - contract_node
    # TODO support mounting src/ to enable local development & testing
    volumes:
      - ../public:/usr/src/app/public

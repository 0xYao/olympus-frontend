version: "3.2"
services:
  # Runs the Hardhat node on an ongoing basis
  contract_node:
    image: 0xjem/olympus-contracts:docker
    entrypoint: npm run start
    ports:
      - 8545:8545
    # When running using CI, we are likely to define these values through environment variables
    environment:
      - PRIVATE_KEY=${CONTRACT_NODE_PRIVATE_KEY}
      - ALCHEMY_API_KEY=${CONTRACT_NODE_ALCHEMY_API_KEY}
    # But the .env file is more likely for local development
    env_file:
      - .env
  frontend:
    build:
      context: ..
      dockerfile: tests/Dockerfile
    ports:
      - 3000:3000
    depends_on:
      - contract_node
    volumes:
      - ../public:/usr/src/app/public
